<script src="/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>

<script src="/lib/require.js"></script> 
<script src="/lib/jquery-ui/jquery.js"></script>

<script src="/lib/jquery-ui/jquery-ui.js"></script>

<!--<script src="/lib/jobad/js/JOBAD.template.js"></script> -->

<script src="/lib/office-ribbon/ribbon/ribbon.js" type="text/javascript"></script>
<link href="/lib//office-ribbon/ribbon/ribbon.css" rel="Stylesheet" type="text/css" />
<link href="/lib/jquery-ui/css/smoothness/jquery-ui.css" rel="Stylesheet" type="text/css" />

<script type="text/javascript" src="/lib/jquery.terminal/jquery.terminal-min.js"></script>
<script type="text/javascript" src="/lib/jquery.layout-latest.min.js"></script>

<link rel="stylesheet" type="text/css" href="/lib/jquery.terminal/css/jquery.terminal.css" />

<link rel="stylesheet" type="text/css" href="editor_tools.css" />

<body>

  <div style="position:absolute; width: 50%; height: 50%; left: 10px; top: 5px;">

<div id="editor" style="height: 500px; width: 100% ">
  A prime number is a circular prime 
  if all numbers generated by cyclically permuting of its digits are prime.\\\\
  For example, $197$ is a circular prime, because $971$ and $719$ also primes.
</div>
</div>

    <script type="text/javascript">
        require.config({
            paths: {
                    "main": "editor_utils.min",
                    "sally_client" : "extlibs/sally_client",
                    "EventEmitter" : "/lib/EventEmitter.min",
                    "theo" : "extlibs/theo",
                    "frames" : "extlibs/frames",
                    "text" : "extlibs/text",
                    "repository" : "extlibs/repository",
            }
        });

        editor = ace.edit("editor");
        editor.setTheme("ace/theme/textmate");

        editor.getSession().setMode("ace/mode/latex");
        require(["editor_tools/main", "sally_client", "theo", "frames", "text", "repository"], function(main, SallyClient, Theo, Frames, Text, Repository) {
            var env = null;
            handlers = main.enrich_editor(editor, "#editor", {root_path : ""});

            toolbar = handlers.toolbar;
            interpretter = handlers.interpretter;

            jQuery.get("macros/menu_layout.json", function (data) {
              toolbar.loadLayout(data);
              jQuery(handlers.header).find(".ribbon").ribbon(); 
            });

            jQuery.get("macros/preferences.json", function (data) {
              env = interpretter.loadAPI(data);
              jQuery(handlers.header).find(".ribbon").ribbon();
            });

            var theo = new Theo();
            var frames = new Frames();
            var text = new Text(editor);
            
            var menu = toolbar.addMenu("Home");
            var section = toolbar.addSection(menu, "MathHub");

            frames.on("NewDocLevelService", function(msg) {
              toolbar.addItem(section, msg.id, msg.icon)
              interpretter.addImplementation(msg.id, function() {
                frames.executeDocLevelService(msg.id);
              });
            });

            frames.on("RemoveDocLevelService", function(msg) {
              toolbar.removeItem(section, msg.id)
            });

            client = new SallyClient({stompUrl: "ws://localhost:61614", stompUser : "webclient", stompPassword : "webclient"});

            client.register([theo, frames, text], "env"+Math.floor(Math.random()*100000), function() {

            });

        });


</script>
</body>